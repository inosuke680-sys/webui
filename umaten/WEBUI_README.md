# ウマ店 WordPress自動投稿システム - Web UI

## 概要

Web UIを使用して、食べログのURLから記事を一括生成・投稿できるシステムです。

## 機能

✅ **URL一括入力** - 複数のURLを一度に送信可能、入力欄は動的に追加可能
✅ **カテゴリ選択** - 自動判定または手動選択（個別・一括指定）
✅ **リアルタイムモニタリング** - CPU・メモリ・トークン使用量をリアルタイム表示
✅ **トークン使用量統計** - 分間・時間・日間・総合の使用量と費用を表示
✅ **時産量制御** - 1時間あたりの記事生成数を設定可能
✅ **バックグラウンド処理** - キューイングシステムで安定した処理
✅ **進捗表示** - 各ジョブの処理状況をリアルタイムで確認

## セットアップ

### 1. 依存パッケージのインストール

```bash
pip install -r requirements_webui.txt
```

### 2. Web UIの起動

```bash
python web_ui.py
```

起動すると以下のように表示されます：

```
============================================================
   ウマ店 WordPress自動投稿システム - Web UI
============================================================
   URL: http://localhost:5000
============================================================
```

### 3. ブラウザでアクセス

```
http://localhost:5000
```

## 使い方

### 基本的な使用方法

1. **設定の確認**
   - 「設定」パネルで時産量（記事/時間）を設定
   - 自動公開にチェックを入れると公開状態で投稿（デフォルトは下書き）
   - 「設定を保存」をクリック

2. **カテゴリの選択**
   - **自動判定**: 住所から自動的に地名カテゴリを選択
   - **手動選択**: WordPressのカテゴリツリーから選択

3. **URLの入力**
   - 食べログのURLを入力
   - 「+ URL欄を追加」で入力欄を増やせます
   - 複数のURLを一度に入力可能

4. **記事生成開始**
   - 「🚀 記事生成開始」ボタンをクリック
   - ジョブがキューに追加され、順次処理されます

5. **進捗確認**
   - 「処理状況」パネルで各ジョブの進捗を確認
   - 完了したら投稿URLが表示されます

### システムモニター

**CPU使用率**: 現在のCPU使用率をリアルタイム表示
**メモリ使用率**: 現在のメモリ使用率をリアルタイム表示
**処理待ち**: キューに入っているジョブ数
**処理状態**: 現在処理中かどうか

### トークン使用量

各期間ごとのトークン使用量とAPI費用を表示：

- **分間**: 直近1分間の統計
- **時間**: 直近1時間の統計
- **日間**: 直近24時間の統計
- **総合**: アプリ起動から累計

表示内容：
- 記事数
- Input/Output トークン数
- API費用（Sonnet 4.5: Input $3/MTok, Output $15/MTok）

### 時産量制御

**時産量（記事/時間）** を設定することで、1時間あたりの記事生成数を制限できます。

例：
- `10` に設定すると、1時間に10記事まで生成
- `60` に設定すると、1分に1記事のペース

これにより、API制限を避けながら安定した運用が可能です。

## 高度な使用方法

### カテゴリの個別指定

手動選択モードで、各URLに対して異なるカテゴリを指定することも可能です（将来的な拡張機能）。

### バッチ処理

多数のURLを一度に送信すると、キューイングシステムが自動的に処理を分散します。時産量の設定に従って順次処理されます。

## トラブルシューティング

### ポートが既に使用されている

```bash
# ポート5000を使用しているプロセスを確認
netstat -ano | findstr :5000

# プロセスを終了
taskkill /PID <プロセスID> /F
```

### モジュールが見つからないエラー

```bash
# 必要なパッケージを再インストール
pip install -r requirements_webui.txt
```

### WordPressに接続できない

- `config/config.yaml` の設定を確認
- WordPress REST APIが有効か確認
- Application Passwordが正しいか確認

## 注意事項

- Web UIは`localhost`でのみアクセスできます
- 本番環境で使用する場合は、適切なセキュリティ設定が必要です
- 大量のジョブを送信する場合は、時産量を適切に設定してください
- API費用を確認しながら使用してください（1記事あたり約$0.02-0.03）

## システム要件

- Python 3.8以上
- Windows 10/11
- 2GB以上の空きメモリ
- インターネット接続

## ライセンス

このプロジェクトは内部使用のためのものです。
